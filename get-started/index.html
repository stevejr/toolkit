


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for GitOps Toolkit.">
      
      
        <link rel="canonical" href="https://fluxcd.github.io/toolkit/get-started/">
      
      
        <meta name="author" content="The Flux CD contributors">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.0">
    
    
      
        <title>Get Started - GitOps Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.89dc9fe3.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecd4686e.min.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../_static/custom.css">
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#get-started-with-gitops-toolkit" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://fluxcd.github.io/toolkit/" title="GitOps Toolkit" class="md-header-nav__button md-logo" aria-label="GitOps Toolkit">
      
  <img src="../_files/flux-icon@2x.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            GitOps Toolkit
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Get Started
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/fluxcd/toolkit" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    fluxcd/toolkit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://fluxcd.github.io/toolkit/" title="GitOps Toolkit" class="md-nav__button md-logo" aria-label="GitOps Toolkit">
      
  <img src="../_files/flux-icon@2x.png" alt="logo">

    </a>
    GitOps Toolkit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/fluxcd/toolkit" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    fluxcd/toolkit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Get Started
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="Get Started" class="md-nav__link md-nav__link--active">
      Get Started
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-the-toolkit-cli" class="md-nav__link">
    Install the toolkit CLI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitops-workflow" class="md-nav__link">
    GitOps workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#staging-bootstrap" class="md-nav__link">
    Staging bootstrap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#staging-workflow" class="md-nav__link">
    Staging workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-bootstrap" class="md-nav__link">
    Production bootstrap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-workflow" class="md-nav__link">
    Production workflow
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Toolkit Components
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Toolkit Components" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Toolkit Components
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Source Controller
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Source Controller" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Source Controller
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../components/source/controller/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../components/source/gitrepositories/" title="GitRepository CRD" class="md-nav__link">
      GitRepository CRD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../components/source/helmrepositories/" title="HelmRepository CRD" class="md-nav__link">
      HelmRepository CRD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../components/source/api/" title="Source API Reference" class="md-nav__link">
      Source API Reference
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Kustomize Controller
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Kustomize Controller" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Kustomize Controller
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../components/kustomize/controller/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../components/kustomize/kustomization/" title="Kustomization CRD" class="md-nav__link">
      Kustomization CRD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../components/kustomize/api/" title="Kustomize API Reference" class="md-nav__link">
      Kustomize API Reference
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Toolkit CLI
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Toolkit CLI" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Toolkit CLI
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_bootstrap/" title="Bootstrap" class="md-nav__link">
      Bootstrap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_bootstrap_github/" title="Bootstrap github" class="md-nav__link">
      Bootstrap github
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_bootstrap_gitlab/" title="Bootstrap gitlab" class="md-nav__link">
      Bootstrap gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_check/" title="Check" class="md-nav__link">
      Check
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_create/" title="Create" class="md-nav__link">
      Create
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_create_kustomization/" title="Create kustomization" class="md-nav__link">
      Create kustomization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_create_source/" title="Create source" class="md-nav__link">
      Create source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_create_source_git/" title="Create source git" class="md-nav__link">
      Create source git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_delete/" title="Delete" class="md-nav__link">
      Delete
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_delete_kustomization/" title="Delete kustomization" class="md-nav__link">
      Delete kustomization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_delete_source/" title="Delete source" class="md-nav__link">
      Delete source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_delete_source_git/" title="Delete source git" class="md-nav__link">
      Delete source git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_export/" title="Export" class="md-nav__link">
      Export
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_export_kustomization/" title="Export kustomization" class="md-nav__link">
      Export kustomization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_export_source/" title="Export source" class="md-nav__link">
      Export source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_export_source_git/" title="Export source git" class="md-nav__link">
      Export source git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_get/" title="Get" class="md-nav__link">
      Get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_get_kustomizations/" title="Get kustomizations" class="md-nav__link">
      Get kustomizations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_get_sources/" title="Get sources" class="md-nav__link">
      Get sources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_get_sources_git/" title="Get sources git" class="md-nav__link">
      Get sources git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_install/" title="Install" class="md-nav__link">
      Install
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_resume/" title="Resume" class="md-nav__link">
      Resume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_resume_kustomization/" title="Resume kustomization" class="md-nav__link">
      Resume kustomization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_suspend/" title="Suspend" class="md-nav__link">
      Suspend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_suspend_kustomization/" title="Suspend kustomization" class="md-nav__link">
      Suspend kustomization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_sync/" title="Sync" class="md-nav__link">
      Sync
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_sync_kustomization/" title="Sync kustomization" class="md-nav__link">
      Sync kustomization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_sync_source/" title="Sync source" class="md-nav__link">
      Sync source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_sync_source_git/" title="Sync source git" class="md-nav__link">
      Sync source git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmd/tk_uninstall/" title="Uninstall" class="md-nav__link">
      Uninstall
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../roadmap/" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-the-toolkit-cli" class="md-nav__link">
    Install the toolkit CLI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitops-workflow" class="md-nav__link">
    GitOps workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#staging-bootstrap" class="md-nav__link">
    Staging bootstrap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#staging-workflow" class="md-nav__link">
    Staging workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-bootstrap" class="md-nav__link">
    Production bootstrap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-workflow" class="md-nav__link">
    Production workflow
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="get-started-with-gitops-toolkit">Get started with GitOps Toolkit<a class="headerlink" href="#get-started-with-gitops-toolkit" title="Permanent link">&para;</a></h1>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>You will need two Kubernetes clusters version 1.14 or newer and kubectl version 1.18.
For a quick local test, you can use <a href="https://kind.sigs.k8s.io/docs/user/quick-start/">Kubernetes kind</a>.
Any other Kubernetes setup will work as well though.</p>
<p>In order to follow the guide you'll need a GitHub account and a 
<a href="https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line">personal access token</a>
that can create repositories (check all permissions under <code>repo</code>).</p>
<p>Export your GitHub personal access token and username:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">GITHUB_TOKEN</span><span class="o">=</span>&lt;your-token&gt;
<span class="nb">export</span> <span class="nv">GITHUB_USER</span><span class="o">=</span>&lt;your-username&gt;
</code></pre></div>

<h2 id="install-the-toolkit-cli">Install the toolkit CLI<a class="headerlink" href="#install-the-toolkit-cli" title="Permanent link">&para;</a></h2>
<p>To install the latest <code>tk</code> release run:</p>
<div class="highlight"><pre><span></span><code>curl -s https://toolkit.fluxcd.io/install.sh <span class="p">|</span> sudo bash
</code></pre></div>

<p>The install script downloads the tk binary to <code>/usr/local/bin</code>.
Binaries for macOS and Linux AMD64 are available for download on the 
<a href="https://github.com/fluxcd/toolkit/releases">release page</a>.</p>
<p>To configure your shell to load tk completions add to your bash profile:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ~/.bashrc or ~/.bash_profile</span>
. &lt;<span class="o">(</span>tk completion<span class="o">)</span>
</code></pre></div>

<h2 id="gitops-workflow">GitOps workflow<a class="headerlink" href="#gitops-workflow" title="Permanent link">&para;</a></h2>
<p>You'll be using a dedicated Git repository e.g. <code>fleet-infra</code> to manage one or more Kubernetes clusters.
This guide assumes that you have two clusters, one for staging and one for production.</p>
<p>Using the toolkit CLI you'll do the following:</p>
<ul>
<li>configure each cluster to synchronise with a directory inside the fleet repository</li>
<li>register app sources (git repositories) that contain plain Kubernetes manifests or Kustomize overlays</li>
<li>configure app deployments on both clusters (pre-releases on staging, semver releases on production)</li>
</ul>
<h2 id="staging-bootstrap">Staging bootstrap<a class="headerlink" href="#staging-bootstrap" title="Permanent link">&para;</a></h2>
<p>Create the staging cluster using Kubernetes kind or set the kubectl context to an existing cluster:</p>
<div class="highlight"><pre><span></span><code>kind create cluster --name staging
kubectl cluster-info --context kind-staging
</code></pre></div>

<p>Verify that your staging cluster satisfies the prerequisites with:</p>
<div class="highlight"><pre><span></span><code>$ tk check --pre

► checking prerequisites
✔ kubectl 1.18.3 &gt;=1.18.0
✔ kubernetes 1.18.2 &gt;=1.14.0
✔ prerequisites checks passed
</code></pre></div>

<p>Run the bootstrap command:</p>
<div class="highlight"><pre><span></span><code>tk bootstrap github <span class="se">\</span>
  --owner<span class="o">=</span><span class="nv">$GITHUB_USER</span> <span class="se">\</span>
  --repository<span class="o">=</span>fleet-infra <span class="se">\</span>
  --path<span class="o">=</span>staging-cluster <span class="se">\</span>
  --personal
</code></pre></div>

<p>The bootstrap command creates a repository if one doesn't exist and
commits the toolkit components manifests to the master branch at the specified path.
Then it configures the target cluster to synchronize with the specified path inside the repository.</p>
<p>If you wish to create the repository under a GitHub organization:</p>
<div class="highlight"><pre><span></span><code>tk bootstrap github <span class="se">\</span>
  --owner<span class="o">=</span>&lt;organization&gt; <span class="se">\</span>
  --repository<span class="o">=</span>&lt;repo-name&gt; <span class="se">\</span>
  --team<span class="o">=</span>&lt;team1-slug&gt; <span class="se">\</span>
  --team<span class="o">=</span>&lt;team2-slug&gt; <span class="se">\</span>
  --path<span class="o">=</span>staging-cluster
</code></pre></div>

<p>Example output:</p>
<div class="highlight"><pre><span></span><code>$ tk bootstrap github --owner=gitopsrun --repository=fleet-infra --path=staging-cluster --team=devs

► connecting to github.com
✔ repository created
✔ devs team access granted
✔ repository cloned
✚ generating manifests
✔ components manifests pushed
► installing components in gitops-system namespace
namespace/gitops-system created
customresourcedefinition.apiextensions.k8s.io/gitrepositories.source.fluxcd.io created
customresourcedefinition.apiextensions.k8s.io/helmcharts.source.fluxcd.io created
customresourcedefinition.apiextensions.k8s.io/helmrepositories.source.fluxcd.io created
customresourcedefinition.apiextensions.k8s.io/kustomizations.kustomize.fluxcd.io created
customresourcedefinition.apiextensions.k8s.io/profiles.kustomize.fluxcd.io created
role.rbac.authorization.k8s.io/crd-controller-gitops-system created
rolebinding.rbac.authorization.k8s.io/crd-controller-gitops-system created
clusterrolebinding.rbac.authorization.k8s.io/cluster-reconciler-gitops-system created
service/source-controller created
deployment.apps/kustomize-controller created
deployment.apps/source-controller created
networkpolicy.networking.k8s.io/deny-ingress created
Waiting for deployment &quot;source-controller&quot; rollout to finish: 0 of 1 updated replicas are available...
deployment &quot;source-controller&quot; successfully rolled out
deployment &quot;kustomize-controller&quot; successfully rolled out
✔ install completed
► configuring deploy key
✔ deploy key configured
► generating sync manifests
✔ sync manifests pushed
► applying sync manifests
◎ waiting for cluster sync
✔ bootstrap finished
</code></pre></div>

<p>If you prefer GitLab, export <code>GITLAB_TOKEN</code> env var and use the command <a href="../cmd/tk_bootstrap_gitlab/">tk bootstrap gitlab</a>.</p>
<div class="admonition hint">
<p class="admonition-title">Idempotency</p>
<p>It is safe to run the bootstrap command as many times as you want.
If the toolkit components are present on the cluster,
the bootstrap command will perform an upgrade if needed.
You can target a specific toolkit <a href="https://github.com/fluxcd/toolkit/releases">version</a>
with <code>tk bootstrap --version=&lt;semver&gt;</code>.</p>
</div>
<h2 id="staging-workflow">Staging workflow<a class="headerlink" href="#staging-workflow" title="Permanent link">&para;</a></h2>
<p>Clone the repository with:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/<span class="nv">$GITHUB_USER</span>/fleet-infra
<span class="nb">cd</span> fleet-infra
</code></pre></div>

<p>Create a git source pointing to a public repository master branch:</p>
<div class="highlight"><pre><span></span><code>tk create <span class="nb">source</span> git webapp <span class="se">\</span>
  --url<span class="o">=</span>https://github.com/stefanprodan/podinfo <span class="se">\</span>
  --branch<span class="o">=</span>master <span class="se">\</span>
  --interval<span class="o">=</span>30s <span class="se">\</span>
  --export &gt; ./staging-cluster/webapp-source.yaml
</code></pre></div>

<p>Create a kustomization for synchronizing the common manifests on the cluster:</p>
<div class="highlight"><pre><span></span><code>tk create kustomization webapp-common <span class="se">\</span>
  --source<span class="o">=</span>webapp <span class="se">\</span>
  --path<span class="o">=</span><span class="s2">&quot;./deploy/webapp/common&quot;</span> <span class="se">\</span>
  --prune<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  --validate<span class="o">=</span>client <span class="se">\</span>
  --interval<span class="o">=</span>1h <span class="se">\</span>
  --export &gt; ./staging-cluster/webapp-common.yaml
</code></pre></div>

<p>Create a kustomization for the backend service that depends on common: </p>
<div class="highlight"><pre><span></span><code>tk create kustomization webapp-backend <span class="se">\</span>
  --depends-on<span class="o">=</span>webapp-common <span class="se">\</span>
  --source<span class="o">=</span>webapp <span class="se">\</span>
  --path<span class="o">=</span><span class="s2">&quot;./deploy/webapp/backend&quot;</span> <span class="se">\</span>
  --prune<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  --validate<span class="o">=</span>client <span class="se">\</span>
  --interval<span class="o">=</span>10m <span class="se">\</span>
  --health-check<span class="o">=</span><span class="s2">&quot;Deployment/backend.webapp&quot;</span> <span class="se">\</span>
  --health-check-timeout<span class="o">=</span>2m <span class="se">\</span>
  --export &gt; ./staging-cluster/webapp-backend.yaml
</code></pre></div>

<p>Create a kustomization for the frontend service that depends on backend: </p>
<div class="highlight"><pre><span></span><code>tk create kustomization webapp-frontend <span class="se">\</span>
  --depends-on<span class="o">=</span>webapp-backend <span class="se">\</span>
  --source<span class="o">=</span>webapp <span class="se">\</span>
  --path<span class="o">=</span><span class="s2">&quot;./deploy/webapp/frontend&quot;</span> <span class="se">\</span>
  --prune<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  --validate<span class="o">=</span>client <span class="se">\</span>
  --interval<span class="o">=</span>10m <span class="se">\</span>
  --health-check<span class="o">=</span><span class="s2">&quot;Deployment/frontend.webapp&quot;</span> <span class="se">\</span>
  --health-check-timeout<span class="o">=</span>2m <span class="se">\</span>
  --export &gt; ./staging-cluster/webapp-frontend.yaml
</code></pre></div>

<p>Push changes to origin:</p>
<div class="highlight"><pre><span></span><code>git add -A <span class="o">&amp;&amp;</span> git commit -m <span class="s2">&quot;add staging webapp&quot;</span> <span class="o">&amp;&amp;</span> git push
</code></pre></div>

<p>In about 30s the synchronization should start:</p>
<div class="highlight"><pre><span></span><code>$ watch tk get kustomizations

✔ gitops-system last applied revision master/35d5765a1acb9e9ce66cad7274c6fe03eee1e8eb
✔ webapp-backend reconciling
✔ webapp-common last applied revision master/f43f9b2eb6766e07f318d266a99d2ec7c940b0cf
✗ webapp-frontend dependency &#39;gitops-system/webapp-backend&#39; is not ready
</code></pre></div>

<p>When the synchronization finishes you can check that the webapp services are running:</p>
<div class="highlight"><pre><span></span><code>$ kubectl -n webapp get deployments,services

NAME                       READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/backend    1/1     1            1           4m1s
deployment.apps/frontend   1/1     1            1           3m31s

NAME               TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)             AGE
service/backend    ClusterIP   10.52.10.22   &lt;none&gt;        9898/TCP,9999/TCP   4m1s
service/frontend   ClusterIP   10.52.9.85    &lt;none&gt;        80/TCP              3m31s
</code></pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>From this moment forward, any changes made to the webapp
Kubernetes manifests in the master branch will be synchronised with the staging cluster.</p>
</div>
<p>If a Kubernetes manifest is removed from the webapp repository, the reconciler will remove it from your cluster.
If you delete a kustomization from the <code>fleet-infra</code> repo, the reconciler will remove all Kubernetes objects that
were previously applied from that kustomization.</p>
<p>If you alter the webapp deployment using <code>kubectl edit</code>, the changes will be reverted to match
the state described in git. When dealing with an incident, you can pause the recitation of a
kustomization with <code>tk suspend kustomization &lt;name&gt;</code>. Once the debugging session
is over, you can re-enable the reconciliation with <code>tk resume kustomization &lt;name&gt;</code>.</p>
<h2 id="production-bootstrap">Production bootstrap<a class="headerlink" href="#production-bootstrap" title="Permanent link">&para;</a></h2>
<p>On production clusters, you may wish to deploy stable releases of an application.
When creating a git source instead of a branch, you can specify a git tag or a semver expression. </p>
<p>Create the production cluster using Kubernetes kind or set the kubectl context to an existing cluster:</p>
<div class="highlight"><pre><span></span><code>kind create cluster --name production
kubectl cluster-info --context kind-production
</code></pre></div>

<p>Run the bootstrap for the production environment:</p>
<div class="highlight"><pre><span></span><code>tk bootstrap github <span class="se">\</span>
  --owner<span class="o">=</span><span class="nv">$GITHUB_USER</span> <span class="se">\</span>
  --repository<span class="o">=</span>fleet-infra <span class="se">\</span>
  --path<span class="o">=</span>prod-cluster <span class="se">\</span>
  --personal
</code></pre></div>

<p>Pull the changes locally:</p>
<div class="highlight"><pre><span></span><code>git pull
</code></pre></div>

<h2 id="production-workflow">Production workflow<a class="headerlink" href="#production-workflow" title="Permanent link">&para;</a></h2>
<p>Create a git source using a semver range to target stable releases:</p>
<div class="highlight"><pre><span></span><code>tk create <span class="nb">source</span> git webapp <span class="se">\</span>
  --url<span class="o">=</span>https://github.com/stefanprodan/podinfo <span class="se">\</span>
  --tag-semver<span class="o">=</span><span class="s2">&quot;&gt;=4.0.0 &lt;4.0.2&quot;</span> <span class="se">\</span>
  --interval<span class="o">=</span>30s <span class="se">\</span>
  --export &gt; ./prod-cluster/webapp-source.yaml
</code></pre></div>

<p>Create a kustomization for webapp pointing to the production overlay:</p>
<div class="highlight"><pre><span></span><code>tk create kustomization webapp <span class="se">\</span>
  --source<span class="o">=</span>webapp <span class="se">\</span>
  --path<span class="o">=</span><span class="s2">&quot;./deploy/overlays/production&quot;</span> <span class="se">\</span>
  --prune<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  --validate<span class="o">=</span>client <span class="se">\</span>
  --interval<span class="o">=</span>10m <span class="se">\</span>
  --health-check<span class="o">=</span><span class="s2">&quot;Deployment/frontend.production&quot;</span> <span class="se">\</span>
  --health-check<span class="o">=</span><span class="s2">&quot;Deployment/backend.production&quot;</span> <span class="se">\</span>
  --health-check-timeout<span class="o">=</span>2m <span class="se">\</span>
  --export &gt; ./prod-cluster/webapp-production.yaml
</code></pre></div>

<p>Push changes to origin:</p>
<div class="highlight"><pre><span></span><code>git add -A <span class="o">&amp;&amp;</span> git commit -m <span class="s2">&quot;add prod webapp&quot;</span> <span class="o">&amp;&amp;</span> git push
</code></pre></div>

<p>List git sources:</p>
<div class="highlight"><pre><span></span><code>$ tk get sources git

✔ gitops-system last fetched revision master/99072ee132abdead8b7799d7891eae2f524eb73d
✔ webapp last fetched revision 4.0.1/113360052b3153e439a0cf8de76b8e3d2a7bdf27
</code></pre></div>

<p>The kubectl equivalent is <code>kubectl -n gitops-system get gitrepositories</code>.</p>
<p>List kustomization:</p>
<div class="highlight"><pre><span></span><code>$ tk get kustomizations

✔ gitops-system last applied revision master/99072ee132abdead8b7799d7891eae2f524eb73d
✔ webapp last applied revision 4.0.1/113360052b3153e439a0cf8de76b8e3d2a7bdf27
</code></pre></div>

<p>The kubectl equivalent is <code>kubectl -n gitops-system get kustomizations</code>.</p>
<p>If you want to upgrade to the latest 4.x version, you can change the semver expression to:</p>
<div class="highlight"><pre><span></span><code>tk create <span class="nb">source</span> git webapp <span class="se">\</span>
  --url<span class="o">=</span>https://github.com/stefanprodan/podinfo <span class="se">\</span>
  --tag-semver<span class="o">=</span><span class="s2">&quot;&gt;=4.0.0 &lt;5.0.0&quot;</span> <span class="se">\</span>
  --interval<span class="o">=</span>30s <span class="se">\</span>
  --export &gt; ./prod-cluster/webapp-source.yaml

git add -A <span class="o">&amp;&amp;</span> git commit -m <span class="s2">&quot;update prod webapp&quot;</span> <span class="o">&amp;&amp;</span> git push
</code></pre></div>

<p>Trigger a git sync:</p>
<div class="highlight"><pre><span></span><code>$ tk sync ks gitops-system --with-source 

► annotating source gitops-system
✔ source annotated
◎ waiting for git sync
✔ git sync completed
✔ fetched revision master/d751ea264d48bf0db8b588d1d08184834ac8fec9
◎ waiting for kustomization sync
✔ kustomization sync completed
✔ applied revision master/d751ea264d48bf0db8b588d1d08184834ac8fec9
</code></pre></div>

<p>The kubectl equivalent is <code>kubectl -n gitops-system annotate gitrepository/gitops-system source.fluxcd.io/syncAt="$(date +%s)"</code>.</p>
<p>Wait for the webapp to be upgraded:</p>
<div class="highlight"><pre><span></span><code>$ watch tk get kustomizations

✔ gitops-system last applied revision master/d751ea264d48bf0db8b588d1d08184834ac8fec9
✔ webapp last applied revision 4.0.5/f43f9b2eb6766e07f318d266a99d2ec7c940b0cf
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href=".." title="Introduction" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Introduction
              </div>
            </div>
          </a>
        
        
          <a href="../components/source/controller/" title="Overview" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Overview
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.36cbf620.min.js"></script>
      <script src="../assets/javascripts/bundle.00c583dd.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>